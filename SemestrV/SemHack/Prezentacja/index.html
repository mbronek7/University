<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />

  <title>Bezpieczeństwo WWW</title>

  <meta name="description" content="A framework for easily creating beautiful presentations using HTML" />
  <meta name="author" content="Hakim El Hattab" />

  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

  <link rel="stylesheet" href="css/reveal.css" />
  <link rel="stylesheet" href="css/theme/moon.css" id="theme" />

  <!-- Theme used for syntax highlighting of code -->
  <link rel="stylesheet" href="lib/css/zenburn.css" />

  <!-- Printing and PDF exports -->
  <script>
    var link = document.createElement("link");
    link.rel = "stylesheet";
    link.type = "text/css";
    link.href = window.location.search.match(/print-pdf/gi) ?
      "css/print/pdf.css" :
      "css/print/paper.css";
    document.getElementsByTagName("head")[0].appendChild(link);
  </script>

  <!--[if lt IE 9]> <script src="lib/js/html5shiv.js"></script> <![endif]-->
</head>

<body>
  <div class="reveal">
    <!--
        Any section element inside of this container is displayed as a slide
      -->
    <div class="slides">
      <section>
        <h1>Bezpieczeństwo</h1>
        <h3>aplikacji WWW</h3>
      </section>

      <section>
        <section>
          <h2>O czym jest ta prezentacja?</h2>
          <p class="fragment">Będzie lekko chaotyczna 😉</p>
          <aside class="notes">
            W sumie to już sam nie wiem :P
            Ale wiem, że będzie < KLIK>
          </aside>
        </section>
        <section>
          <h2>Porozmawiamy o</h2>
          <p class="fragment grow highlight-green">Metodach zabezpieczeń (te które znam)</p>
          <p class="fragment grow highlight-green">Popularne luki w zabezpieczeniach</p>
          <p class="fragment grow highlight-green">Analiza zdarzeń związanych z bezpieczeństwem</p>
          <aside class="notes">
            Analiza - "powłamaniowa"
          </aside>
        </section>
      </section>
      </section>
      <section>
        <section>
          <h2>XSS</h2>
          <p class="fragment">Cross-Site Scripting</p>
          <aside class="notes">
            - najpopularniejsza luka w bezpieczeństwie aplikacji web
          </aside>
        </section>
        <section>
          <p class="fragment">1. Obity XSS</p>
          <p class="fragment">2. Zapisany XSS</p>
          <aside class="notes">
            odbity- apka przyjmuje parametry na wejśćiu i odzwierciedla je na wygenerowanej stronie WWW
            zapisany - zapisujemy dane wejściowe do bazy, a następnie jak się zapisze to pokaże się każdej osobie!
          </aside>
        </section>
        <section>
          Jak sprawdzić czy strona jest podatna na XSS?
          <p class="fragment">{}[];()<>'"</p>
          <aside class="notes">
            Sprawdzamy czy te znaki znajdą się na stronie w niezmienionej formie
          </aside>
        </section>
        <section>
          <pre class="fragment"><code class="js" data-trim contenteditable>
           <a href="javascript:alert("BUU")>Show</a>
          </code></pre>
          <aside class="notes">
            Odbity Najłatwiej popdmienić wartość w hrefie na kod JS
          </aside>
        </section>
        <section>
          <pre class="fragment"><code class="js" data-trim contenteditable>
            https://www.example.com/users/sth?next_page=/adres_www
          </code></pre>
          <pre class="fragment"><code class="js" data-trim contenteditable>
              https://www.example.com/users/sth?next_page=javascript:alert("BUU")
            </code></pre>
          <aside class="notes">
            No fajnie ale jak podmienić tą wartość, dla kogoś innego niż my :P
            Co możemy - zabrać wszystkie pliki cookie, a pomyślmy że admin wchodzi na naszą stronę
          </aside>
        </section>
        <section>
          <h2>Podstawowe zabezpieczenie - Filtrowanie</h2>
        </section>
        <section>
          <p class="fragment">HTML Eecaping</p>
          <pre class="fragment"><code class="rb" data-trim contenteditable>
              { '&' => '&amp;', '>' => '&gt;', '<' => '&lt;', '"' => '&quot;', "'" => '&#39;' }
            </code></pre>
          <aside class="notes">
            Domyślnie w większości frameworków itp.
          </aside>
        </section>
        <section>
          <p class="fragment">Gdzie mogły zostać luki?</p>
          <pre class="fragment"><code class="js" data-trim contenteditable>
              [BUU](javascript:alert("BU"))
            </code></pre>
          <aside class="notes">
            Ok fajnie mamy wszędzie filtrowanie itp, czy jesteśmy bezpieczni?
          </aside>
        </section>
        <section>
          <p class="fragment">API</p>
          <aside class="notes">
            Mamy na stronie niskopopziomowe API, przyklłąd slack i wysyłąnie wiadommośći, i id użytkownika nawet
          </aside>
        </section>
        <section>
          <h2 class="fragment">Cookie</h2>
          <p class="fragment">HTTPOnly</p>
          <aside class="notes">
            Raz jeszcze o cookie jest HTTPOnly, klient nie może takich cookie odczytać przez document.cookie, pomijając
            szyfrowwanie
          </aside>
        </section>
        <section>
          <h2 class="fragment">Z jakich narzędzi korzystają atakujący</h2>
          <img class="fragment" data-src="img/1.jpg">
        </section>
        <section>
          <h2 class="fragment">The Browser Exploitation Framework</h2>
          <aside class="notes">
            Uruchamiamy na naszym serwerze i wysyłamy jako XSS ofiarze
            skrypt do połaćzenia
          </aside>
        </section>
        <section>
          <p class="fragment">Logi z całej przeglądarki</p>
          <p class="fragment">Lokalizacja, skrypty,dodatki w przeglądarce, cookie</p>
          <p class="fragment">Komendy i polecenia, które możemy wysyłć do przeglądarki ofiary</p>
          <img class="fragment" data-src="img/2.jpg">

          <aside class="notes">
            Mamy dostęp do:
            Możemy wysyłąć żądania do różnych witryn z przeglądarki ofiary np:
            Jest zalogowany na fb, niech się połączy z naszą aplikacją
          </aside>
        </section>
      </section>
      <section>
        <section>
          <h2>CSRF</h2>
          <p class="fragment">Cross-Site Request Forgery</p>
          <aside class="notes">
            Oszukujemy sewrwer, że na przeglądarce użytkownik jest zalogowany
          </aside>
        </section>
        <section>
          <p class="fragment">Interesują nas głównie akcję POST i GET</p>
          <pre class="fragment"><code class="js" data-trim contenteditable>
            https://zapisy.com/user/save/class?username=Michal&second_name=Bronikowski&token=13QWEFVQV231WV123
          </code></pre>
          <aside class="notes">
            Ok, ale więszość aplikacji ma token zabezpieczający :P
            A nawet więcej tokeny w nagłówkach żadania, token w Origin itp
            SEO - Boty Googla dasz im nagłówek - znasz IP
          </aside>
        </section>
        <section>
          <h2>Popularne błędy</h2>
          <p class="fragment">"Losowy" token złożony z cyfr od 1 do 100</p>
          <p class="fragment">Jeden i ten sam token dla wszystkich użytkowników</p>
          <p class="fragment">Dowalna losowa wartośc tokena zostanie zaakceptowana przez serwer</p>
          <p class="fragment">Token "atrapa"</p>
        </section>
        <section>
          <h2>XMLHttpRequest</h2>
          <aside class="notes">
            Żeby nie było tak różówo
          </aside>
        </section>
        <section>
          <p class="fragment">X-Requested-With</p>
          <aside class="notes">
            Dodatkowy nagłówek, którego nie da się podać z poziomu formularza
          </aside>
        </section>
        <section>
          <h2 class="fragment">FLASH</h2>
          <aside class="notes">
            ALE zawsze jest coś co nam popsuje naszą utopię.
          </aside>
        </section>
        <section>
          <p class="fragment">Mamy akcję POST</p>
          <p class="fragment">Tworzymy plik SWF, który wysyła żądanie na nasz serwer</p>
          <p class="fragment">Nasz serwer odpowiada 307</p>
          <aside class="notes">
            2. Oczywiście nagłówek mamy ustawiony, z tej strony
            3. 307 - Temporary Redirect na ofiarę
          </aside>
        </section>
      </section>
      <section>
        <section>
          <h2 class="fragment">SQL Injection</h2>
        </section>
        <section>
            <pre class="fragment"><code class="rb" data-trim contenteditable>
              User.delete_all("id = #{params[:id]}")
            </code></pre>
            <pre class="fragment"><code class="rb" data-trim contenteditable>
                params[:id] = "1) OR 1=1"
              </code></pre>
              <pre class="fragment"><code class="rb" data-trim contenteditable>
                  DELETE FROM "users" WHERE (id = 1) OR 1=1)
                </code></pre>
        </section>
        <section>
            <pre class="fragment"><code class="rb" data-trim contenteditable>
                User.where(:admin => false).group(params[:group])
            </code></pre>
            <pre class="fragment"><code class="rb" data-trim contenteditable>
                params[:group] = "name UNION SELECT * FROM users"
            </code></pre>
            <pre class="fragment"><code class="rb" data-trim contenteditable>
                SELECT "users".* FROM "users" WHERE "users"."admin" = ? GROUP BY name UNION SELECT * FROM users
            </code></pre>
            <aside class="notes">
                Jak można takie coś zepsuć? Suma zbiorów - UNION
            </aside>
        </section>
        <section>
            <pre class="fragment"><code class="rb" data-trim contenteditable>
                Guest.where("event_id = #{params[:id]}")
            </code></pre>
            <pre class="fragment"><code class="rb" data-trim contenteditable>
                Guest.where(event_id: params[:id])
            </code></pre>
            <aside class="notes">
                Co robimy w Railsowym ORMIE?
                1 - zle czysta interpolacja
            </aside>
        </section>
        <section>
            <p class="fragment">Chcę metodę dostępną w konkretnym systemie zarządzania bazami SQL</p>
            <aside class="notes">
                Co jeśli i ORM mi tego nie obsługuje?
            </aside>
        </section>
        <section>
            <pre class="fragment"><code class="rb" data-trim contenteditable>
                class PostWithPopularityQuery
                POPULARITY_RANGES = 5

                  def self.call
                    Post.find_by_sql ['
                      SELECT
                        id, title, visit_count, description,
                      ntile(?) OVER (
                        ORDER BY visit_count ASC
                      ) AS popularity
                      FROM posts', POPULARITY_RANGES]
                  end
                end
            </code></pre>
            <aside class="notes">
                ntile - POSTGRESQL - Window Functions
            </aside>
        </section>
        <section>
            <pre class="fragment"><code class="rb" data-trim contenteditable>
                conn = ActiveRecord::Base.connection
                name = conn.quote("Michał Bronikowski")
                title = conn.quote(nil)
                query = "INSERT INTO users (name,title) VALUES (#{name}, #{title})"
                conn.execute(query)
            </code></pre>
            <aside class="notes">
                RAILS - quote function
            </aside>
        </section>
        <section>
        <pre class="fragment"><code class="rb" data-trim contenteditable>
            rails c                                                                                                                                                                                                        0.10   21:27    4.67G 
            Running via Spring preloader in process 18504
            Loading development environment (Rails 5.2.1)
            a = "name UNION SELECT * FROM users"
             => "name UNION SELECT * FROM users"
            2.5.1 :005 > ActiveRecord::Base.connection.quote(a)
             => "'name UNION SELECT * FROM users'"
        </code></pre>
        </section>
        <section>
            <img class="fragment" data-src="img/3.png">
        </section>
        <section>
            <img class="fragment" data-src="img/4.jpeg">
            <aside class="notes">
                Tak po za tym, ale to póżniej
            </aside>
        </section>
      </section>
      <section>
        <section>
          <p class="fragment">Narzędzia przydatne przy analizie błędów bezpieczeństwa aplikacji</p>
          <aside class="notes">
              Te z których ja korzystam i które ja znam
          </aside>
        </section>
        <section>
            <img class="fragment" data-src="img/5.png">
        </section>
        <section>
            <img class="fragment" data-src="img/6.png">
        </section>
        <section>
            <h2 class="fragment">Rack::Attack</h2>
            <aside class="notes">
                Kickstarter
            </aside>
        </section>
        <section>
            <h2 class="fragment">bundler-audit</h2>
            <img class="fragment" data-src="img/7.png">
        </section>
        <section>
            <img class="fragment" data-src="img/8.png">
        </section>
        <section>
            <h2 class="fragment">Po co miałbym to od razu aktualizować?</h2>
        </section>
        <section>
            <h2 class="fragment">Shodan</h2>
        </section>
      </section>
      <section>
        <section>
          <h2 class="fragment">Jak zabezpieczyć dane klientów</h2>
          <aside class="notes">
              Phishing itp.
          </aside>
        </section>
        <section>
            <pre class="fragment"><code class="rb" data-trim contenteditable>
                class ApplicationController < ActionController::Base

                before_action :set_cache_headers
                
                  private
                
                  def set_cache_headers
                    response.headers["Cache-Control"] = "no-cache, no-store"
                    response.headers["Pragma"] = "no-cache"
                    response.headers["Expires"] = "Fri, 01 Jan 1990 00:00:00 GMT"
                  end
                end
            </code></pre>
        </section>

      </section>
      <section>
        <h2>Zalety</h2>
        <p class="fragment grow highlight-green">Wczesne wykrycie błędów</p>
        <p class="fragment grow highlight-green">
          Wiemy, że wersja produkcyjna na pewno działa
        </p>
        <p class="fragment grow highlight-green">
          Testy są częścią dokumentacji naszego projektu
        </p>
        <aside class="notes">
          Dzięki testom zobaczymy jak dana klasa działa, co zwraca; jak
          działa system; jakie funkcjonalności były zaimplementowane. Taka
          dokumentacja jest niezmiernie przydatna, gdy wrócimy do projektu
          po paru miesiącach.(A "prawdziwa dokumentacja niezostała jeszce
          napisana")
        </aside>
      </section>
      </section>

      <section>
        <section>
          <h2>TDD?</h2>
          <p>Test-Driven-Development</p>
        </section>
        <section>
          <p>W skrócie proces tworzenia aplikacji zorientowany testowo.</p>
        </section>
        <section>
          <p>Co to właściwie znaczy?</p>
          <p class="fragment fade-up">
            Zobaczmy na przykładzie dodawania nowej funkcjonalnośći
          </p>
        </section>
        <section data-background="#ff0000">
          <p style="color: #fff">
            Piszemy testy, które tę funkcjonalność sprawdzają
          </p>
          <aside class="notes">
            Oczywiście wszystkie testy kończą się porażka -- brak
            zaimplementowanej funkcjonalności
          </aside>
        </section>
        <section data-background="#00ff50">
          <p style="color: #fff">
            Piszemy kod, który ma spełniać nową funkcjonalność
          </p>
          <aside class="notes">Kod nie musi być optymalny</aside>
        </section>
        <section data-background="#02adf7">
          <p style="color: #fff">Refaktoryzacja</p>
          <aside class="notes">
            Proces wprowadzania otymalizacji w naszym kodzie
          </aside>
        </section>
      </section>

      <section>
        <section>
          <h2>BDD?</h2>
          <p>Behaviour-Driven-Development</p>
        </section>
        <section>
          Tworzenie oprogramowania na podstawie scenariuszy z perspektywy
          klienta
        </section>
        <section>
          <p>W skrócie klient opisuje nam jak ma działać aplikacja.</p>
          <p class="fragment">
            Deweloper "zadaje" pytania aplikacji i sprawdza odpowiedź
          </p>
        </section>
        <section>
          <p>Każdy scenariusz składa się z kilku części:</p>
          <p class="fragment">– tytułu</p>
          <p class="fragment">– narracji</p>
          <p class="fragment">– kryteriów akceptacji</p>
        </section>
        <section>
          <p>Wiem dziwnie to brzmi, zobaczmy więc przykład:</p>

          <pre class="fragment"><code class="hlruby" data-trim contenteditable>
                                                        RSpec.feature "Post creation", :type => :feature do
                                                        scenario "User creates a new post" do
                                                          visit "/widgets/new"

                                                          fill_in "Title", :with => "My Post"
                                                          fill_in "Body", :with => "Lorem Ipsum dorum ..."
                                                          click_button "Create Post"

                                                          expect(page).to have_text("Post was successfully created.")
                                                        end
                                                  end		
                        </code></pre>
        </section>
        <section>
          <p>Filozofia:</p>
          <p class="fragment">"ask, don't tell"</p>
        </section>
        <section>
          <p>Schemat pracy jest podobny jak w TDD</p>
        </section>
      </section>
      <section>
        <section>
          <h2>Różnice</h2>
        </section>
        <section>
          <p>
            Testy BDD pisane są z myslą o użytkowniku końcowym, pomagaja
            programistom lepiej zrozumieć oczekiwania "biznesu", nie tylko
            przetestować aplikację.
          </p>
        </section>
        <section>
          <p>
            BDD sprawdza czy czynność została wykonana, nie sprawdza w
            przeciwieństwie do TDD poprawności algorytmu.
          </p>
        </section>
        <section>
          <iframe src="https://giphy.com/embed/5mQLalaELSytO" width="335" height="480" frameborder="0" class="giphy-embed"
            allowfullscreen></iframe>
          <p>
            <a href="https://giphy.com/gifs/perfect-loops-sucks-5mQLalaELSytO"></a>
          </p>
          <aside class="notes">
            TDD sprawdza i wynik i proces jego otrzymania.
          </aside>
        </section>
        <section>
          <p>
            Dzięki BDD analizujemy, planujemy i projektujemy tyle, ile
            naprawdę trzeba.
          </p>
        </section>
      </section>
      <section>
        <h2 class="fragment">Najpierw piszemy testy, potem kod 😱</h2>
      </section>
      <section>
        <section>
          <h2>Jakie testy pisać?</h2>
        </section>
        <section>
          <p class="fragment">Jednostkowe</p>
          <p class="fragment">Funkcjonalne/Akceptacyjne</p>
          <p class="fragment">Przeglądarkowe</p>
          <p class="fragment">Wydajnościowe</p>
          <aside class="notes">
            ***Jednostkowe (ang. Unit tests) – testują kod poprzez wykonywanie
            testów weryfikujących poprawność działania
            obiektów/modułów/systemów ***Funkcjonalne/akceptacyjne (ang.
            Functional tests) – sprawdzające czy system działa poprawnie na
            zasadzie czarnej skrzynki (ang. black-box) -testy czarnej
            skrzynki, ponieważ osoba testująca nie ma dostępu do informacji na
            temat budowy programu, który testuje. ***Przeglądarkowe - testują
            zachowanie systemu poprzez odpalenie go w przeglądarce i testy na
            prawdziwej stronie ***Wydajnościowe - testujące wydajność systemu
            przy dużych obciążeniach
          </aside>
        </section>
      </section>
      <section>
        <h2>Czas na mały przykład 😉</h2>
      </section>
    </div>
  </div>

  <script src="lib/js/head.min.js"></script>
  <script src="js/reveal.js"></script>

  <script>
    // More info https://github.com/hakimel/reveal.js#configuration
    Reveal.initialize({
      controls: true,
      progress: true,
      history: true,
      center: true,

      transition: "slide", // none/fade/slide/convex/concave/zoom

      // More info https://github.com/hakimel/reveal.js#dependencies
      dependencies: [{
          src: "lib/js/classList.js",
          condition: function () {
            return !document.body.classList;
          }
        },
        {
          src: "plugin/markdown/marked.js",
          condition: function () {
            return !!document.querySelector("[data-markdown]");
          }
        },
        {
          src: "plugin/markdown/markdown.js",
          condition: function () {
            return !!document.querySelector("[data-markdown]");
          }
        },
        {
          src: "plugin/highlight/highlight.js",
          async: true,
          callback: function () {
            hljs.initHighlightingOnLoad();
          }
        },
        {
          src: "plugin/search/search.js",
          async: true
        },
        {
          src: "plugin/zoom-js/zoom.js",
          async: true
        },
        {
          src: "plugin/notes/notes.js",
          async: true
        }
      ]
    });
  </script>
</body>

</html>